function removeCookieById(e,t){document.cookie="ps_product_"+t+"-"+e+"=; "+["Thu, 18 Dec 2013 12:00:00 UTC; path="+global.base_path].join("")}function ced_ps_do_bulk_actions(){if("delete"==jQuery("select[name=action]").val()){var e=window.location.href,t=[],s=[];jQuery.each(jQuery("input[name='shortlist_product[]']:checked"),function(){t.push(jQuery(this).data("key")),s.push(jQuery(this).data("userid"))}),jQuery.ajax({url:global.ajaxurl,type:"post",data:{action:"bulk_delete",ids:t,user:s},success:function(o){for(var i=0;i<=t.length;i++)removeCookieById(t[i],s[i]);window.location.assign(e)}})}}jQuery(document).ready(function(e){e("#ced_ps_select_pages").select2({placeholder:global.page_placeholder,allowClear:!0}),e("#ced_ps_select_position").select2({placeholder:global.position_placeholder,allowClear:!0}),e("#ced_ps_select_discount_type").select2({placeholder:global.position_placeholder,allowClear:!0}),e("#ced_ps_expiry_time").on("keypress",function(t){return 8!=t.which&&0!=t.which&&(t.which<48||t.which>57)?(e("#ced_ps_exp_error").html(global.digits_only_text),setTimeout(function(){jQuery("#ced_ps_exp_error").html("")},3e3),!1):void 0}),e(document).on("click","button.notice-dismiss",function(){e(this).parents("div#message").remove()}),e("#ced_ps_save_general_settings").on("click",function(){var t=jQuery("#ced_ps_select_pages").val(),s=jQuery("#ced_ps_select_position option:selected").attr("data"),o=jQuery("#ced_ps_select_discount_type option:selected").attr("data"),i=jQuery("#ced_ps_expiry_time").val(),l=jQuery("#shortlist-background-color").val(),a=jQuery("#shortlist-addtocart-background-color").val(),d=jQuery("#shortlist-font-color").val(),c=jQuery("#shortlist-addtocart-font-color").val(),n=jQuery("#ced_ps_save_shortlist_text").val(),_=jQuery("#ced_ps_save_removeall_text").val(),r=jQuery("#removeall-font-color").val(),p=jQuery("#shortlist-removeall-color").val(),u="";""==n&&(n="SHORTLIST"),""==_&&(_="REMOVE ALL"),""==t||null==t||null==o||"undefined"==typeof t?(e("#ced_ps_pages_error").html(global.empty_pages_selection),setTimeout(function(){jQuery("#ced_ps_pages_error").html("")},3e3)):""==s||null==s||null==o||"undefined"==typeof s||null==l||""==n||null==d||null==c||null==a||null==p||""==_||null==r?(e("#ced_ps_position_error").html(global.empty_position_selection),setTimeout(function(){jQuery("#ced_ps_position_error").html("")},3e3)):""==i||null==i?(e("#ced_ps_exp_error").html(global.invalid_exp),setTimeout(function(){jQuery("#ced_ps_exp_error").html("")},3e3)):0==i||"0"==i?(e("#ced_ps_exp_error").html(global.exp_greater_than_zero),setTimeout(function(){jQuery("#ced_ps_exp_error").html("")},3e3)):0>i?(e("#ced_ps_exp_error").html(global.exp_not_negative),setTimeout(function(){jQuery("#ced_ps_exp_error").html("")},3e3)):(e(".ced_ps_content_wrapper").css("opacity","0.6"),e("#ced_ps_loading_wrapper").show(),jQuery.post(global.ajaxurl,{action:"save_general_settings",security_check:global.ced_ps_nonce,selected_pages:t,selected_position:s,discount_type:o,shortlist_background_color:l,shortlist_addtocart_background_color:a,shortlist_font_color:d,shortlist_addtocart_font_color:c,shortlist_text:n,removeall_text:_,removeall_font_color:r,shortlist_removeall_background_color:p,exp_time:i},function(t){e("#ced_ps_loading_wrapper").hide(),e(".ced_ps_content_wrapper").css("opacity","1"),"success"==e.trim(t)?(u='<div class="updated notice is-dismissible" id="message">',u+="<p>"+global.setting_saved_text+"</p>",u+='<button class="notice-dismiss" type="button">',u+='<span class="screen-reader-text">Dismiss this notice.</span>',u+="</button>",u+="</div>",e("#ced_ps_message").html(u),setTimeout(function(){window.location.href=window.location.href},5e3)):(u='<div class="updated error notice is-dismissible" id="message">',u+="<p>"+global.setting_failed_text+"</p>",u+='<button class="notice-dismiss" type="button">',u+='<span class="screen-reader-text">Dismiss this notice.</span>',u+="</button>",u+="</div>",e("#ced_ps_message").html(u))}))}),e(document).on("click","#delete_admin_side",function(){var t=e(this).data("pid"),s=e(this).data("userid");e("#ced_ps_loading_wrapper_"+s+t).show(),e.ajax({url:global.ajaxurl,type:"post",data:{action:"delete_products_admin_side",product_id:t,user_id:s,date:e(this).data("date"),security_check:global.ced_ps_nonce},success:function(o){console.log(e(document).find("#shortlisted_product_"+s+t)),e(document).find("#shortlisted_product_"+s+t).remove(),removeCookieById(t,s),e("#ced_ps_loading_wrapper_"+s+t).hide(),notice_html='<div class="updated notice is-dismissible" id="message">',notice_html+="<p>Product Deleted successfully</p>",notice_html+='<button class="notice-dismiss" type="button">',notice_html+='<span class="screen-reader-text">Dismiss this notice.</span>',notice_html+="</button>",notice_html+="</div>",e("#ced_ps_success_message").html(notice_html)}})}),e(document).on("blur","#product_discount_admin_side",function(){var t=e(this).data("pid"),s=e(this).data("userid"),o=e(this).data("date"),i=e(this).data("rowid"),l=e(this).val();e("#ced_ps_loading_wrapper_"+s+t).show(),e.ajax({url:global.ajaxurl,type:"post",data:{action:"add_discount_product_admin_side",product_id:t,user_id:s,date:o,row_id:i,discount:l,security_check:global.ced_ps_nonce},success:function(o){1!=o||""==l&&0==l?(0==l||""==l)&&(e("#shortlisted_product_"+s+t).find("#admin-send-mail").hide(),e("#shortlisted_product_"+s+t).find("#admin-send-mail").removeClass("available_discount"),e("#shortlisted_product_"+s+t).find("#admin-send-mail").addClass("not_available_discount"),e("#shortlisted_product_"+s+t).find("#admin-send-mail").attr("data-discount",0)):(e("#shortlisted_product_"+s+t).find("#admin-send-mail").show(),e("#shortlisted_product_"+s+t).find("#admin-send-mail").removeClass("not_available_discount"),e("#shortlisted_product_"+s+t).find("#admin-send-mail").addClass("available_discount"),e("#shortlisted_product_"+s+t).find("#admin-send-mail").attr("data-discount",l)),e("#ced_ps_loading_wrapper_"+s+t).hide(),notice_html='<div class="updated notice is-dismissible" id="message">',notice_html+="<p>Discount provided successfully</p>",notice_html+='<button class="notice-dismiss" type="button">',notice_html+='<span class="screen-reader-text">Dismiss this notice.</span>',notice_html+="</button>",notice_html+="</div>",e("#ced_ps_success_message").html(notice_html)}})}),e(document).on("click","#admin-send-mail",function(){var t=e(this).data("pid"),s=e(this).data("userid"),o=e(this).data("discount");e("#ced_ps_loading_wrapper_"+s+t).show(),e.ajax({url:global.ajaxurl,type:"post",data:{action:"send_mail_to_user",product_id:t,user_id:s,discount:o,security_check:global.ced_ps_nonce},success:function(o){if(1==o){var i='<td><input type="button" class="button button-primary" id="admin-send-mail" value="Send Mail"></td>';e("td#prod_action").show(),e("tr#shortlisted_product_"+t).append(i)}e("#ced_ps_loading_wrapper_"+s+t).hide(),notice_html='<div class="updated notice is-dismissible" id="message">',notice_html+="<p>Email sent successfully</p>",notice_html+='<button class="notice-dismiss" type="button">',notice_html+='<span class="screen-reader-text">Dismiss this notice.</span>',notice_html+="</button>",notice_html+="</div>",e("#ced_ps_success_message").html(notice_html)}})}),e(".ced-ps-color-picker").wpColorPicker()});